<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Club.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Readers_Club</a> &gt; <a href="index.source.html" class="el_package">readersClub</a> &gt; <span class="el_source">Club.java</span></div><h1>Club.java</h1><pre class="source lang-java linenums">package readersClub;

import java.util.Objects;
import java.util.Iterator;
import java.util.Random;
import java.util.HashMap;
import java.util.ArrayList;
import java.util.PriorityQueue;

/**
 *
 * @author Wilson Omokoro
 */
<span class="nc" id="L14">public class Club {</span>

<span class="fc" id="L16">    public static PriorityQueue&lt;String&gt; staffList = new PriorityQueue();</span>
<span class="fc" id="L17">    public static PriorityQueue&lt;String&gt; studentsList = new PriorityQueue();</span>
<span class="fc" id="L18">    public static ArrayList books = new ArrayList();</span>
<span class="fc" id="L19">    public static HashMap&lt;String, ArrayList&gt; bookRequests = new HashMap();</span>

    /**
     * Execution starting point of the reader's club program.
     * @param args 
     */
    public static void main(String[] args) {
        //create some books
<span class="nc" id="L27">        createBook(&quot;Frankinstein&quot;, &quot;06672679&quot;, &quot;Mary Shelley&quot;);</span>
<span class="nc" id="L28">        createBook(&quot;Spectre&quot;, &quot;7665923&quot;, &quot;Ian Fleming&quot;);</span>
<span class="nc" id="L29">        createBook(&quot;Havoc Junction&quot;, &quot;9008765&quot;, &quot;Joe Donnelly&quot;);</span>
<span class="nc" id="L30">        createBook(&quot;Finders Keepers&quot;, &quot;0087765&quot;, &quot;Steven King&quot;);</span>

        //create some enthusiastic club members. Some are staff, some are students
<span class="nc" id="L33">        Staff m1 = (Staff) createMember(&quot;Christina Sass&quot;, &quot;Female&quot;, 29, true);</span>
<span class="nc" id="L34">        Student m2 = (Student) createMember(&quot;Harry Smith&quot;, &quot;Male&quot;, 17, false);</span>
<span class="nc" id="L35">        Student m3 = (Student) createMember(&quot;Jane Doe&quot;, &quot;Female&quot;, 16, false);</span>
<span class="nc" id="L36">        Student m4 = (Student) createMember(&quot;Dipo Isola&quot;, &quot;Male&quot;, 18, false);</span>
<span class="nc" id="L37">        Staff m5 = (Staff) createMember(&quot;Tosin Adesanya&quot;, &quot;Male&quot;, 27, true);</span>
<span class="nc" id="L38">        Staff m6 = (Staff) createMember(&quot;Florence Okosun&quot;, &quot;Female&quot;, 26, true);</span>
<span class="nc" id="L39">        Staff m7 = (Staff) createMember(&quot;Jeremy Johnson&quot;, &quot;Male&quot;, 32, true);</span>

        // display staff and students' list
<span class="nc" id="L42">        System.out.println(&quot;Staff Queue &gt;&gt;&gt; &quot; + staffList);</span>
<span class="nc" id="L43">        System.out.println(&quot;Students' Queue &gt;&gt;&gt; &quot; + studentsList);</span>

        // display books
<span class="nc" id="L46">        System.out.println(&quot;\nBooks' status before being borrowed:&quot;);</span>
<span class="nc" id="L47">        displayBooks();</span>

        // some members will request for books
<span class="nc" id="L50">        System.out.println(&quot;&quot;);</span>
<span class="nc" id="L51">        m3.requestForBook(&quot;Spectre&quot;);</span>
<span class="nc" id="L52">        m4.requestForBook(&quot;Spectre&quot;);</span>
<span class="nc" id="L53">        m1.requestForBook(&quot;Spectre&quot;);</span>
<span class="nc" id="L54">        m6.requestForBook(&quot;Havoc Junction&quot;);</span>
<span class="nc" id="L55">        m5.requestForBook(&quot;Havoc Junction&quot;);</span>
<span class="nc" id="L56">        m2.requestForBook(&quot;Havoc Junction&quot;);</span>

        //borrow books to members who requested for them
<span class="nc" id="L59">        borrowBooks();</span>

        // display books
<span class="nc" id="L62">        System.out.println(&quot;\nBooks' status after being borrowed:&quot;);</span>
<span class="nc" id="L63">        displayBooks();</span>
<span class="nc" id="L64">    }</span>

    /**
     * This method is used to create books for the reader's club.
     * @param title
     * @param isbn
     * @param author
     * @return 
     */
    public static boolean createBook(String title, String isbn, String author) {
<span class="fc" id="L74">        Book book = null;</span>
<span class="fc" id="L75">        int copies = new Random().nextInt(3) + 1;</span>

<span class="fc bfc" id="L77" title="All 2 branches covered.">        for (int i = 0; i &lt; copies; i++) {</span>
<span class="fc" id="L78">            book = new Book(title, isbn, author);</span>
<span class="fc" id="L79">            book.setNoOfCopies(copies);</span>
<span class="fc" id="L80">            books.add(book);</span>
        }

<span class="fc" id="L83">        return Objects.nonNull(book);</span>
    }

    /**
     * This method simply displays all the existing books and their current state
     */
    public static void displayBooks() {
<span class="nc bnc" id="L90" title="All 2 branches missed.">        for (int i = 0; i &lt; books.size(); i++) {</span>
<span class="nc" id="L91">            Book b = (Book) books.get(i);</span>
<span class="nc" id="L92">            System.out.println(b.title + &quot;. (available: &quot; + b.isAvailable + &quot;)&quot;);</span>
        }
<span class="nc" id="L94">    }</span>

    /**
     * This method is used to create the two categories of members of the readers club; staff and students
     * @param name
     * @param sex
     * @param age
     * @param isStaff
     * @return 
     */
    public static Members createMember(String name, String sex, int age, boolean isStaff) {
        Members member;

<span class="pc bpc" id="L107" title="1 of 2 branches missed.">        if (isStaff) {</span>
<span class="fc" id="L108">            member = new Staff(name, sex, age, isStaff);</span>
<span class="fc" id="L109">            staffList.add(member.name);</span>
        } else {
<span class="nc" id="L111">            member = new Student(name, sex, age, isStaff);</span>
<span class="nc" id="L112">            studentsList.add(member.name);</span>
        }

<span class="fc" id="L115">        return member;</span>
    }

    /**
     * When members request to borrow books, this method logs the members requests
     * @param member
     * @param bookTitle
     * @return 
     */
    public static boolean logBookRequest(Members member, String bookTitle) {
<span class="fc" id="L125">        System.out.println(member.name + &quot; has requested to borrow a copy of \&quot;&quot; + bookTitle + &quot;\&quot;&quot;);</span>
        ArrayList requesters;
<span class="fc" id="L127">        boolean requestLogged = false;</span>

<span class="pc bpc" id="L129" title="1 of 2 branches missed.">        if (bookRequests.containsKey(bookTitle)) {</span>
<span class="nc" id="L130">            requesters = (ArrayList) bookRequests.get(bookTitle);</span>
        } else {
<span class="fc" id="L132">            requesters = new ArrayList();</span>
        }

<span class="fc" id="L135">        requesters.add(member);</span>
<span class="fc" id="L136">        bookRequests.put(bookTitle, requesters);</span>
<span class="fc" id="L137">        requestLogged = true;</span>

<span class="fc" id="L139">        return requestLogged;</span>
    }

    /**
     * This method handles the actual process of borrowing books to members based on rank and position in queue.
     * @return 
     */
    public static int borrowBooks() {
<span class="fc" id="L147">        int borrowedBooksCount = 0;</span>
        //Next for loop iterates through all book requests. Book requests are handled one after the other
<span class="fc bfc" id="L149" title="All 2 branches covered.">        for (String key : bookRequests.keySet()) {</span>
<span class="fc" id="L150">            String bookTitle = key;</span>
<span class="fc" id="L151">            System.out.println(&quot;\nProcessing request(s) for \&quot;&quot; + bookTitle + &quot;\&quot;...&quot;);</span>

<span class="fc" id="L153">            ArrayList requesters = bookRequests.get(bookTitle);</span>
<span class="fc" id="L154">            int noOfPeopleRequesting = requesters.size();</span>

<span class="fc" id="L156">            System.out.println(noOfPeopleRequesting + &quot; person(s) requested for \&quot;&quot; + bookTitle + &quot;\&quot;.&quot;);</span>
<span class="fc" id="L157">            System.out.println(getAvailableCopiesCount(bookTitle) + &quot; copies of \&quot;&quot; + bookTitle + &quot;\&quot; are available.&quot;);</span>
 
            /*
            Next for loop performs 2 iterations to iterate through both members' queues;
            first iteration covers the staff queue, and next iteration covers the students' queue
            */
<span class="fc bfc" id="L163" title="All 2 branches covered.">            for (int g = 0; g &lt;= 1; g++) {</span>
                Iterator it;
<span class="fc bfc" id="L165" title="All 2 branches covered.">                if (g == 0) {</span>
<span class="fc" id="L166">                    it = staffList.iterator();</span>
                } else {
<span class="fc" id="L168">                    it = studentsList.iterator();</span>
                }

                /*
                Next while loop checks the names of members who made a request against the names of each member on
                the current queue
                */
                String nameInQueue;
<span class="fc bfc" id="L176" title="All 2 branches covered.">                while (it.hasNext()) {</span>
<span class="fc" id="L177">                    nameInQueue = (String) it.next();</span>
                    /*
                    Next for loop checks if the current member extracted in the previous line is among 
                    members who made a request for the book
                    */
<span class="fc bfc" id="L182" title="All 2 branches covered.">                    for (int h = 0; h &lt; noOfPeopleRequesting; h++) {</span>
<span class="fc" id="L183">                        Members m = (Members) requesters.get(h);</span>
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">                        if (m.name.equalsIgnoreCase(nameInQueue)) {</span>
                            /*
                            Next for loop searches the club's books collection for the requested book.
                            If the book is found and a copy is available, it is borrowed to the current member.
                            */
<span class="nc bnc" id="L189" title="All 2 branches missed.">                            for (int i = 0; i &lt; books.size(); i++) {</span>
<span class="nc" id="L190">                                Book b = (Book) books.get(i);</span>
<span class="nc bnc" id="L191" title="All 4 branches missed.">                                if (b.title.equalsIgnoreCase(bookTitle) &amp;&amp; b.isAvailable) {</span>
<span class="nc" id="L192">                                    System.out.println(&quot;Borrowed a copy of \&quot;&quot; + bookTitle + &quot;\&quot; to &quot; + m.name);</span>
<span class="nc" id="L193">                                    b.isAvailable = false;</span>
<span class="nc" id="L194">                                    borrowedBooksCount++;</span>
<span class="nc" id="L195">                                    break;</span>
                                }
                            }
<span class="nc" id="L198">                            break;</span>
                        }
                    }
                }
            }
<span class="fc" id="L203">        }</span>
        
<span class="fc" id="L205">        return borrowedBooksCount;</span>
    }

    /**
     * This method simply returns the number of copies of a particular book that are still available
     * @param bookTitle
     * @return 
     */
    public static int getAvailableCopiesCount(String bookTitle) {
        //iterate through books collection to see how many copies of the requested book are available
<span class="fc" id="L215">        int copiesAvailable = 0;</span>
<span class="fc bfc" id="L216" title="All 2 branches covered.">        for (int i = 0; i &lt; books.size(); i++) {</span>
<span class="fc" id="L217">            Book b = (Book) books.get(i);</span>
<span class="pc bpc" id="L218" title="3 of 4 branches missed.">            if (b.title.equalsIgnoreCase(bookTitle) &amp;&amp; b.isAvailable) {</span>
<span class="nc" id="L219">                copiesAvailable++;</span>
            }
        }

<span class="fc" id="L223">        return copiesAvailable;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.0.201403182114</span></div></body></html>